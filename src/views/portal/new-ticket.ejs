<!DOCTYPE html>
<html lang="pt-BR">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Novo Chamado - Portal do Cliente</title>
    <link rel="icon" type="image/webp" href="/public/favicon.webp" />
    <link rel="stylesheet" href="/public/portal.css" />
  </head>
  <body>
    <div class="app-layout">
      <%- include('../partials/portal-sidebar', { active: 'new-ticket' }) %>
      <%- include('../partials/portal-topbar', { breadcrumb: 'Portal / Novo Chamado' }) %>

      <main class="content">
        <div class="card">
          <div class="card-header"><h1>Abrir Novo Chamado</h1></div>
          <% if (typeof message !== 'undefined' && message) { %>
          <div class="feedback-message success-message"><%= message %></div>
          <% } %> <% if (typeof error !== 'undefined' && error) { %>
          <div class="feedback-message error-message"><%= error %></div>
          <% } %>
          <form action="/portal/tickets" method="POST" enctype="multipart/form-data">
            <div class="form-group">
              <label for="title">* Título</label>
              <input type="text" id="title" name="title" required />
            </div>
            <div class="form-group">
              <label for="priority">* Prioridade</label>
              <select id="priority" name="priority" required>
                <option value="low" selected>Baixa</option>
                <option value="medium">Média</option>
                <option value="high">Alta</option>
              </select>
            </div>
            <div class="form-group">
              <label for="description">* Descrição</label>
              <textarea id="description" name="description" rows="5" required></textarea>
            </div>
            <div class="form-group">
              <label for="attachment">Anexo</label>
              <label for="attachment" class="upload-zone">
                <p>Arraste e solte um arquivo aqui ou clique para selecionar</p>
                <div class="upload-info">TAMANHO MÁX: 5MB</div>
                <p id="file-name"></p>
              </label>
              <input type="file" id="attachment" name="attachment" />
            </div>
            <div class="form-footer">
              <button type="submit" class="btn-submit">Enviar Chamado</button>
            </div>
          </form>
        </div>
      </main>
      <div class="mobile-overlay" id="mobile-overlay"></div>
    </div>
    <%- include('../partials/portal-scripts') %>
    <script>
      const fileInput = document.getElementById("attachment");
      const fileNameDisplay = document.getElementById("file-name");
      if (fileInput) {
        fileInput.addEventListener("change", function () {
          if (this.files.length > 0) {
            fileNameDisplay.textContent = "Arquivo selecionado: " + this.files[0].name;
          } else {
            fileNameDisplay.textContent = "";
          }
        });
      }
    </script>
  </body>
</html>